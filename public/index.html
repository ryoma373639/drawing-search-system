<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>図面検索システム - テスト版</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <!-- ヘッダー -->
    <header class="header">
      <h1>📐 図面検索システム（テスト版）</h1>
      <div class="header-buttons">
        <button id="uploadBtn" class="btn-primary">📤 ファイルを追加</button>
        <button id="clearBtn" class="btn-secondary">🗑️ 全削除</button>
      </div>
    </header>

    <!-- ファイルアップロードエリア -->
    <div class="upload-area" id="uploadArea">
      <input type="file" id="fileInput" multiple accept=".dwg,.dxf,.pdf,.jpg,.jpeg,.png,.tiff,.tif" style="display: none;" />
      <div class="upload-content">
        <p class="upload-icon">📁</p>
        <p class="upload-text">ここにファイルをドラッグ&ドロップ</p>
        <p class="upload-subtext">または「ファイルを追加」ボタンをクリック</p>
        <p class="upload-support">対応形式: .dwg, .dxf, .pdf, .jpg, .png, .tiff</p>
      </div>
    </div>

    <!-- ステータスバー -->
    <div class="status-bar">
      <span id="statusText">準備完了</span>
      <span id="statsText">登録済み: 0件</span>
    </div>

    <!-- 検索バー -->
    <div class="search-container">
      <input
        type="text"
        id="searchInput"
        class="search-input"
        placeholder="図版番号、品名、部品名、施主名で検索..."
        autofocus
      />
      <button id="searchBtn" class="btn-primary">🔍 検索</button>
    </div>

    <!-- ソート/フィルター -->
    <div class="filter-container">
      <div class="filter-group">
        <label for="sortBy">並び順:</label>
        <select id="sortBy" class="filter-select">
          <option value="id">登録日時</option>
          <option value="fileName">ファイル名</option>
          <option value="fileSize">ファイルサイズ</option>
          <option value="drawingNumber">図版番号</option>
        </select>
        <select id="sortOrder" class="filter-select">
          <option value="desc">降順</option>
          <option value="asc">昇順</option>
        </select>
      </div>
      <div class="filter-group">
        <label for="fileTypeFilter">ファイル形式:</label>
        <select id="fileTypeFilter" class="filter-select">
          <option value="">すべて</option>
          <option value="pdf">PDF</option>
          <option value="dwg">DWG</option>
          <option value="dxf">DXF</option>
          <option value="jpg">JPG</option>
          <option value="jpeg">JPEG</option>
          <option value="png">PNG</option>
          <option value="tiff">TIFF</option>
          <option value="tif">TIF</option>
        </select>
      </div>
      <button id="resetFilter" class="btn-secondary-small">🔄 リセット</button>
    </div>

    <!-- 検索結果 -->
    <div class="results-container">
      <div class="results-header">
        <h2>検索結果</h2>
        <span id="resultsCount"></span>
      </div>

      <div id="resultsList" class="results-list">
        <!-- 検索結果がここに表示されます -->
      </div>

      <div id="noResults" class="no-results" style="display: none;">
        <p>検索結果がありません</p>
      </div>

      <div id="welcomeMessage" class="welcome-message">
        <h3>ようこそ！</h3>
        <p>「ファイルを追加」ボタンをクリックするか、</p>
        <p>上のエリアにファイルをドラッグ&ドロップしてください。</p>
        <br>
        <p class="note">※ このテスト版はブラウザのメモリ内にデータを保存します。</p>
        <p class="note">ページをリロードするとデータは消去されます。</p>
      </div>
    </div>
  </div>

  <!-- 編集モーダル -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>メタデータ編集</h2>
        <button class="modal-close" id="closeEditModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="editForm">
          <input type="hidden" id="editId">
          <div class="form-group">
            <label for="editFileName">ファイル名</label>
            <input type="text" id="editFileName" class="form-input" readonly>
          </div>
          <div class="form-group">
            <label for="editDrawingNumber">図版番号</label>
            <input type="text" id="editDrawingNumber" class="form-input" placeholder="図版番号を入力">
          </div>
          <div class="form-group">
            <label for="editProductName">品名</label>
            <input type="text" id="editProductName" class="form-input" placeholder="品名を入力">
          </div>
          <div class="form-group">
            <label for="editPartName">部品名</label>
            <input type="text" id="editPartName" class="form-input" placeholder="部品名を入力">
          </div>
          <div class="form-group">
            <label for="editClientName">施主名</label>
            <input type="text" id="editClientName" class="form-input" placeholder="施主名を入力">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button id="cancelEdit" class="btn-secondary">キャンセル</button>
        <button id="saveEdit" class="btn-primary">保存</button>
      </div>
    </div>
  </div>

  <!-- OCR処理用（Tesseract.js） -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.4/dist/tesseract.min.js"></script>
  <!-- アプリケーションロジック -->
  <script src="app.js"></script>
</body>
</html>
